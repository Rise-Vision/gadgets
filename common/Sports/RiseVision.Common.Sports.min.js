var RiseVision=RiseVision||{};RiseVision.Common=RiseVision.Common||{};RiseVision.Common.Sports={};RiseVision.Common.Sports=function(a){this.displayID=a?a:"xxx";this.sport=prefs.getString("sport");this.collegeGames=prefs.getString("collegeGames");this.allSportsIndex=0;this.updateInterval=6E4;this.allSports="NFL MLB NBA NHL CFOOT CBASK".split(" ");this.viz=new RiseVision.Common.Visualization};
RiseVision.Common.Sports.prototype.getData=function(){var a=this;this.wasReset=!1;if("ALL"==this.sport)this.processData("http://contentsports.appspot.com/sports/"+this.allSports[this.allSportsIndex]+".aspx?View=Scoreboard&LogoStyle=Default"+this.getGroup()+"&DisplayId="+this.displayId,function(){a.onSportLoaded()});else{var d="";if("CFOOT"==this.sport||"CBASK"==this.sport)d="&Group="+this.collegeGames;this.processData("http://contentsports.appspot.com/sports/"+this.sport+".aspx?View=Scoreboard&LogoStyle=Default"+
d+"&DisplayId="+this.displayID,function(){a.onDataLoaded()})}};
RiseVision.Common.Sports.prototype.processData=function(a,d){var b=this;$.ajax({url:a,success:function(a){if(a){var c=a.getElementsByTagName("Game"),f="";b.wasReset||(b.sports=[],b.games=[],b.wasReset=!0);if(a){0<a.getElementsByTagName("Sport").length&&(f=a.getElementsByTagName("Sport")[0].getAttribute("Code"));0<c.length&&(a=b.getNodeValue(a.getElementsByTagName("Title")),b.sports.push({sportCode:f,name:a}));for(a=0;a<c.length;a++){var l="",m="",g=c[a].getElementsByTagName("Team"),n="",k,p,q,e,h;
0<c[a].getElementsByTagName("Status").length&&(l=c[a].getElementsByTagName("Status")[0].getAttribute("Code"));m=b.getNodeValue(c[a].getElementsByTagName("Extended"));0<c[a].getElementsByTagName("Over_Under").length&&0<c[a].getElementsByTagName("Over_Under")[0].getElementsByTagName("Casino").length&&(n="O/U "+c[a].getElementsByTagName("Over_Under")[0].getElementsByTagName("Casino")[0].getAttribute("value"));(h=b.getNodeValue(c[a].getElementsByTagName("Date")))&&(h=Date.parse(h));for(e=0;e<g.length;e++)k=
g[e].getAttribute("Host"),"Visiting"==k?p=b.getTeamInfo(g[e],f):"Home"==k&&(q=b.getTeamInfo(g[e],f));b.games.push({sportCode:f,date:h,status:l,extendedStatus:m,overUnder:n,visitor:p,home:q})}d()}else console.log("Invalid data source URL")}else setTimeout(function(){$(b).trigger("updateTimerExpired")},b.updateInterval)},dataType:"xml"})};
RiseVision.Common.Sports.prototype.onSportLoaded=function(){var a=this,d;this.allSportsIndex++;d=this.getGroup();this.allSportsIndex==this.allSports.length?(this.allSportsIndex=0,this.onDataLoaded()):this.processData("http://contentsports.appspot.com/sports/"+this.allSports[this.allSportsIndex]+".aspx?View=Scoreboard&LogoStyle=Default"+d+"&DisplayId="+this.displayID,function(){a.onSportLoaded()})};
RiseVision.Common.Sports.prototype.getGroup=function(){var a="";if("CFOOT"==this.allSports[this.allSportsIndex]||"CBASK"==this.allSports[this.allSportsIndex])a="&Group="+this.collegeGames;return a};
RiseVision.Common.Sports.prototype.getTeamInfo=function(a,d){var b="";new Image;0<a.getElementsByTagName("Casino").length&&(b=a.getElementsByTagName("Casino")[0].getAttribute("value"));return{name:this.getNodeValue(a.getElementsByTagName("Name")),rank:this.getNodeValue(a.getElementsByTagName("Rank")),overall:this.getNodeValue(a.getElementsByTagName("Overall")),score:this.getNodeValue(a.getElementsByTagName("Total")),spread:b}};
RiseVision.Common.Sports.prototype.getNodeValue=function(a){return 0<a.length&&0<a[0].childNodes.length?a[0].childNodes[0].nodeValue:""};RiseVision.Common.Sports.prototype.onDataLoaded=function(){var a=this;0===this.sports.length?$(this).trigger("noData"):(setTimeout(function(){$(a).trigger("updateTimerExpired")},this.updateInterval),$(this).trigger("imagesLoaded"))};