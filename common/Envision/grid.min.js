(function(){var y=Flotr.EventAdapter,w=Flotr._;Flotr.addPlugin("graphGrid",{callbacks:{"flotr:beforedraw":function(){this.graphGrid.drawGrid()},"flotr:afterdraw":function(){this.graphGrid.drawOutline()}},drawGrid:function(){function f(a){for(s=0;s<a.length;++s){var c=a[s].v/e.max;for(r=0;r<=x;++r)b[0===r?"moveTo":"lineTo"](Math.cos(r*t+u)*v*c,Math.sin(r*t+u)*v*c)}}function d(a,d){w.each(w.pluck(a,"v"),function(a){a<=e.min||a>=e.max||(a==e.min||a==e.max)&&c.outlineWidth||d(Math.floor(e.d2p(a))+b.lineWidth/
2)})}function l(a){b.moveTo(a,0);b.lineTo(a,p)}function a(a){b.moveTo(0,a);b.lineTo(q,a)}var b=this.ctx,n=this.options,c=n.grid,m=c.verticalLines,g=c.horizontalLines,h=c.minorVerticalLines,k=c.minorHorizontalLines,p=this.plotHeight,q=this.plotWidth,e,s,r;(m||h||g||k)&&y.fire(this.el,"flotr:beforegrid",[this.axes.x,this.axes.y,n,this]);b.save();b.lineWidth=1;b.strokeStyle=c.tickColor;if(c.circular){b.translate(this.plotOffset.left+q/2,this.plotOffset.top+p/2);var v=Math.min(p,q)*n.radar.radiusRatio/
2,x=this.axes.x.ticks.length,t=2*(Math.PI/x),u=-Math.PI/2;b.beginPath();e=this.axes.y;g&&f(e.ticks);k&&f(e.minorTicks);m&&w.times(x,function(a){b.moveTo(0,0);b.lineTo(Math.cos(a*t+u)*v,Math.sin(a*t+u)*v)})}else b.translate(this.plotOffset.left,this.plotOffset.top),c.backgroundColor&&(b.fillStyle=this.processColor(c.backgroundColor,{x1:0,y1:0,x2:q,y2:p}),b.fillRect(0,0,q,p)),b.beginPath(),e=this.axes.x,m&&d(e.ticks,l),h&&d(e.minorTicks,l),e=this.axes.y,g&&d(e.ticks,a),k&&d(e.minorTicks,a);b.stroke();
b.restore();(m||h||g||k)&&y.fire(this.el,"flotr:aftergrid",[this.axes.x,this.axes.y,n,this])},drawOutline:function(){var f=this.options,d=f.grid,l=d.outline,a=this.ctx,b=d.backgroundImage,n=this.plotOffset,c=n.left,m=n.top,g=this.plotWidth,h=this.plotHeight,k,p,q;if(d.outlineWidth){a.save();if(d.circular){a.translate(c+g/2,m+h/2);l=Math.min(h,g)*f.radar.radiusRatio/2;f=this.axes.x.ticks.length;c=2*(Math.PI/f);m=-Math.PI/2;a.beginPath();a.lineWidth=d.outlineWidth;a.strokeStyle=d.color;a.lineJoin="round";
for(i=0;i<=f;++i)a[0===i?"moveTo":"lineTo"](Math.cos(i*c+m)*l,Math.sin(i*c+m)*l);a.stroke()}else a.translate(c,m),f=d.outlineWidth,c=0.5-f+(f+1)%2/2,a.lineWidth=f,a.strokeStyle=d.color,a.lineJoin="miter",a.beginPath(),a.moveTo(c,c),g-=f/2%1,h+=f/2,a[-1!==l.indexOf("n")?"lineTo":"moveTo"](g,c),a[-1!==l.indexOf("e")?"lineTo":"moveTo"](g,h),a[-1!==l.indexOf("s")?"lineTo":"moveTo"](c,h),a[-1!==l.indexOf("w")?"lineTo":"moveTo"](c,c),a.stroke(),a.closePath();a.restore();b&&(d=b.src||b,p=(parseInt(b.left,
10)||0)+n.left,q=(parseInt(b.top,10)||0)+n.top,k=new Image,k.onload=function(){a.save();b.alpha&&(a.globalAlpha=b.alpha);a.globalCompositeOperation="destination-over";a.drawImage(k,0,0,k.width,k.height,p,q,g,h);a.restore()},k.src=d)}}})})();