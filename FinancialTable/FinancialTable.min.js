var RiseVision=RiseVision||{};RiseVision.FinancialSettings={},RiseVision.FinancialSettings=function(){this.settings=new RiseVision.Common.Settings},RiseVision.FinancialSettings.prototype.initSettings=function(){var a=this;$("#selector").on("click",function(a){financial.showStockSelector()}),$(".colorPicker").on("click",function(a){financial.showColorPicker($(this).data("for"))}),$(".fontSelector").on("click",function(a){financial.showFontSelector($(this).data("for"))}),$("#scrollDirection").on("change",function(a){"none"==$(this).val()?$("li.scroll").hide():$("li.scroll").show()}),$("#scrollBy").on("change",function(a){"continuous"==$(this).val()?$("li.scrollHold").hide():$("li.scrollHold").show()}),$("#colCount").on("change",function(a){financial.buildFieldsUI()}),$("#useDefault").on("click",function(a){$(this).is(":checked")?$("li.layoutURL").hide():$("li.layoutURL").show()}),gadgets.rpc.call("","rscmd_getAdditionalParams",function(b){if(b){b=JSON.parse(b),$("#disclaimerFont").val(prefs.getString("disclaimerFont")),$("#disclaimerLoc").val(prefs.getString("disclaimerLoc")),$("#acceptance").attr("checked",prefs.getBool("acceptance")),$("#scrollDirection").val(prefs.getString("scrollDirection")),$("#scrollBy").val(prefs.getString("scrollBy")),$("#scrollHold").val(prefs.getInt("scrollHold")),$("#scrollSpeed").val(prefs.getString("scrollSpeed")),$("#scrollResumes").val(prefs.getInt("scrollResumes")),$("#rowPadding").val(prefs.getInt("rowPadding")),$("#colPadding").val(prefs.getInt("colPadding")),$("#colCount").val(prefs.getInt("colCount")),$("#bgColor").val(prefs.getString("bgColor")),$("#rowColor").val(prefs.getString("rowColor")),$("#altRowColor").val(prefs.getString("altRowColor")),$("#selRowColor").val(prefs.getString("selRowColor")),$("#useDefault").attr("checked",prefs.getBool("useDefault")),$("#layoutURL").val(prefs.getString("layoutURL")),a.populateColor($("#rowColor"),prefs.getString("rowColor")),a.populateColor($("#altRowColor"),prefs.getString("altRowColor")),a.populateColor($("#selRowColor"),prefs.getString("selRowColor")),a.populateColor($("#bgColor"),prefs.getString("bgColor")),$("#instruments").val(b.instruments),$("#heading_font-style").text(b.heading_font),$("#heading_font-style").data("css",b["heading_font-style"]),$("#data_font-style").text(b.data_font),$("#data_font-style").data("css",b["data_font-style"]),$("#colCount").trigger("change");for(var c=0;c<parseInt($("#colCount").val());c++)a.initFields(c+1,b.fields[c]);$(".field").trigger("change")}else $("#colCount").trigger("change"),$(".field").trigger("change");$("form ol li ol.drillDown li:visible:last").css({clear:"left",float:"left","margin-bottom":"10px"}),$("#scrollDirection").trigger("change"),$("#scrollBy").trigger("change"),$("#useDefault").triggerHandler("click"),$("#settings").show()})},RiseVision.FinancialSettings.prototype.populateColor=function(a,b){a.val(b),a.css("background-color",b)},RiseVision.FinancialSettings.prototype.initFields=function(a,b){$("#field"+a).val(b.field),$("#alignment"+a).val(b.alignment),$("#width"+a).val(b.width),$("#decimals"+a).val(b.decimals),$("#sign"+a).val(b.sign),$("#condition"+a+"Action").val(b.condition),$("#headerText"+a).val(b.header)},RiseVision.FinancialSettings.prototype.buildFieldsUI=function(){var a=parseInt($("#colCount").val()),b=$(".field").length;if(isNaN(a)||0==a)$(".formatting").hide();else if(a==b)$(".formatting").show();else if(a<b)$(".formatting").hide(),$(".formatting:lt("+a+")").show();else{$(".formatting").show();for(var c=b+1;c<=a;c++){var d=document.createElement("li"),e=document.createElement("ol");e.setAttribute("class","formatting drillDown"),$(e).append($("<li></li>").append("<label for='field"+c+"'>Field*:</label>").append("<select id='field"+c+"' name='field"+c+"' class='field medium'><option value='instrument'>Instrument</option><option value='logo'>Instrument Logo</option><option value='name'>Instrument Name</option><option value='lastPrice'>Last Price</option><option value='historicClose'>Previous Close</option><option value='netChange'>Change</option><option value='percentChange'>% Change</option><option value='accumulatedVolume'>Accumulated Volume</option><option value='dayHigh'>Day High</option><option value='dayLow'>Day Low</option><option value='yearHigh'>52 Week High</option><option value='yearLow'>52 Week Low</option><option value='bid'>Bid</option><option value='ask'>Ask</option><option value='yield'>Yield</option><option value='yieldChange'>Yield Change</option><option value='tradeTime'>Trade Time</option></select>")).append($("<li></li>").append("<label for='alignment"+c+"'>Alignment:</label>").append("<select id='alignment"+c+"' name='alignment"+c+"' class='alignment short'><option value='left' selected='selected'>Left</option><option value='center'>Center</option><option value='right'>Right</option></select>")).append($("<li></li>").append("<label for='width"+c+"'>Width (pixels):</label>").append("<input id='width"+c+"' name='width"+c+"' type='text' class='width short' />")).append($("<li></li>").append("<label for='headerText"+c+c+"'><a href='#' class='tooltip'>Header Text:<span>Custom header text. If not specified, the header from the field will be used.</span></a></label>").append("<input id='headerText"+c+"' name='headerText"+c+"' type='text' class='headerText short' />")).append($("<li class='numeric drilldown'></li>").append($("<ol></ol>").append($("<li></li>").append("<label for='decimals"+c+"'>Decimals:</label>").append("<select id='decimals"+c+"' name='decimals"+c+"' class='decimals short'><option value='0'>0</option><option value='1'>1</option><option value='2' selected='selected'>2</option><option value='3'>3</option><option value='4'>4</option></select>")).append($("<li></li>").append("<label for='sign"+c+"'><a href='#' class='tooltip'>Sign:<span>How to display positive and negative numbers</span></a></label>").append("<select id='sign"+c+"' name='sign"+c+"' class='sign short'><option value='none'>None</option><option value='minus'>-</option><option value='plusMinus'>+/-</option><option value='parentheses'>( )</option><option value='arrow' selected='selected'>Arrow</option></select>")).append($("<li></li>").append("<label for='condition"+c+"'><a href='#' class='tooltip'>Color Condition:<span>Whether or not to use color to indicate positive or negative values, or to indicate a change in value</span></a></label>").append("<select id='condition"+c+"Action' name='condition"+c+"Action' class='condition medium'><option value='none' selected='selected'>None</option><option value='changeUp'>Change Up Green Down Red</option><option value='changeDown'>Change Down Green Up Red</option><option value='valuePositive'>Value Positive Green Negative Red</option><option value='valueNegative'>Value Negative Green Positive Red</option></select>")))),$(d).append(e),$("#bgColor").parent().before(d),$(".field").on("change",function(a){"instrument"!=this.value&&"logo"!=this.value&&"name"!=this.value&&"tradeTime"!=this.value?$(this).parent().parent().find(".numeric").show():$(this).parent().parent().find(".numeric").hide()})}for(var c=b+1;c<=a;c++)$(".field").eq(c-1)[0].selectedIndex=c-1}},RiseVision.FinancialSettings.prototype.showStockSelector=function(){gadgets.rpc.call("","rscmd_openFinancialSelector",null,"instruments",$("#instruments").val())},RiseVision.FinancialSettings.prototype.showColorPicker=function(a){gadgets.rpc.call("","rscmd_openColorPicker",null,a,$("#"+a).val())},RiseVision.FinancialSettings.prototype.showFontSelector=function(a){gadgets.rpc.call("","rscmd_openFontSelector",null,a,$("#"+a).data("css"))},RiseVision.FinancialSettings.prototype.setStocks=function(a,b){$("#"+a).val(b)},RiseVision.FinancialSettings.prototype.setColor=function(a,b){$("#"+a).val(b),$("#"+a).css("background-color",b)},RiseVision.FinancialSettings.prototype.setFont=function(a,b,c){$("#"+a).data("css",b),$("#"+a).text(c)},RiseVision.FinancialSettings.prototype.getSettings=function(){var a=!1,b=document.getElementsByClassName("errors")[0],c="",d=null;return $(".errors").empty(),a=!!financial.settings.validateRequired($("#instruments"),b,"Instruments")||a,a=!!financial.settings.validateNumeric($("#scrollHold"),b,"Scroll Hold")||a,a=!!financial.settings.validateNumeric($("#scrollResumes"),b,"Scroll Resumes")||a,a=!!financial.settings.validateNumeric($("#rowPadding"),b,"Row Padding")||a,a=!!financial.settings.validateNumeric($("#colPadding"),b,"Column Padding")||a,parseInt($("#colCount").val())>0&&($(".field").each(function(c){a=!!financial.settings.validateRequired($(this),b,"Field")||a}),$(".width").each(function(c){a=!!financial.settings.validateNumeric($(this),b,"Width")||a})),a=!!financial.settings.validateRequired($("#layoutURL"),b,"Layout URL")||a,a?($(".errors").fadeIn(200).css("display","inline-block"),$("#wrapper").scrollTop(0),null):(c="up_disclaimerFont="+$("#disclaimerFont").val()+"&up_disclaimerLoc="+$("#disclaimerLoc").val()+"&up_scrollDirection="+$("#scrollDirection").val()+"&up_scrollBy="+$("#scrollBy").val()+"&up_scrollHold="+$("#scrollHold").val()+"&up_scrollSpeed="+$("#scrollSpeed").val()+"&up_scrollResumes="+$("#scrollResumes").val()+"&up_rowPadding="+$("#rowPadding").val()+"&up_colPadding="+$("#colPadding").val()+"&up_colCount="+$("#colCount").val()+"&up_bgColor="+$("#bgColor").val()+"&up_rowColor="+$("#rowColor").val()+"&up_altRowColor="+$("#altRowColor").val()+"&up_selRowColor="+$("#selRowColor").val()+"&up_layoutURL="+escape($("#layoutURL").val()),c+=$("#acceptance").is(":checked")?"&up_acceptance=true":"&up_acceptance=false",c+=$("#useDefault").is(":checked")?"&up_useDefault=true":"&up_useDefault=false",d={params:c,additionalParams:JSON.stringify(financial.saveAdditionalParams())},$(".errors").css({display:"none"}),d)},RiseVision.FinancialSettings.prototype.saveAdditionalParams=function(){var a={},b=[];a.instruments=$("#instruments").val(),a.heading_font=$("#heading_font-style").text(),a["heading_font-style"]=$("#heading_font-style").data("css"),a.data_font=$("#data_font-style").text(),a["data_font-style"]=$("#data_font-style").data("css");for(var c=0;c<parseInt($("#colCount").val());c++)b.push(financial.saveFormatSettings(c+1,b));return a.fields=b,a},RiseVision.FinancialSettings.prototype.saveFormatSettings=function(a){var b={field:$("#field"+a).val(),alignment:$("#alignment"+a).val(),width:$("#width"+a).val(),header:$("#headerText"+a).val()};return $("#decimals"+a+":visible").length>0&&(b.decimals=$("#decimals"+a).val(),b.sign=$("#sign"+a).val(),b.condition=$("#condition"+a+"Action").val()),b},RiseVision.Financial={},RiseVision.Financial=function(a){this.displayID=a,this.scrollDirection=prefs.getString("scrollDirection"),this.scrollBy=prefs.getString("scrollBy"),this.scrollHold=1e3*prefs.getInt("scrollHold"),this.scrollSpeed=prefs.getString("scrollSpeed"),this.scrollResumes=1e3*prefs.getInt("scrollResumes"),this.rowPadding=prefs.getInt("rowPadding")/2+"px",this.colPadding=prefs.getInt("colPadding")/2+"px",this.disclaimerFont=prefs.getString("disclaimerFont"),this.disclaimerLoc=prefs.getString("disclaimerLoc"),this.useDefault=prefs.getBool("useDefault"),this.useDefault?this.layoutURL="":this.layoutURL=prefs.getString("layoutURL"),this.logosURL="https://s3.amazonaws.com/risecontentlogos/financial/",this.hasLogos=!1,this.hasLastItemScrolled=!1,this.updateInterval=6e4,this.selectedIndex=-1,this.isLoading=!0,this.sortConfig={bAutoWidth:!1,bDestroy:!0,bFilter:!1,bInfo:!1,bLengthChange:!1,bPaginate:!1,bSort:!1,sScrollY:"500px"}},RiseVision.Financial.prototype.getInstrument=function(a){return $("tr").removeClass("selected"),$(".item").eq(a).addClass("selected"),$(".item").eq(a).attr("data-code")},RiseVision.Financial.prototype.checkInstruments=function(a){var b=this,c=[],d=[],e=this.data.getNumberOfRows();a&&(this.requested=[]);for(var f=0;f<e;f++)c.push(this.data.getFormattedValue(f,this.financial.dataFields.code));d=$.grep(c,function(a){return $.inArray(a,b.requested)==-1});for(var g=0;g<d.length;g++)this.requested.push(d[g]);d.length>0&&gadgets.rpc.call("","instrumentsChanged",null,this.displayID,d),a&&setTimeout(function(){b.checkInstruments(!0)},864e5)},RiseVision.Financial.prototype.getAdditionalParams=function(a,b){if("additionalParams"==a&&b){var c=document.createElement("style");b=JSON.parse(b),c.appendChild(document.createTextNode(b["heading_font-style"])),c.appendChild(document.createTextNode(b["data_font-style"])),document.getElementsByTagName("head")[0].appendChild(c),financial.instruments=b.instruments,financial.requestedFields=[],$.each(b.fields,function(a,b){"name"==b.field||"logo"==b.field||"instrument"==b.field||"arrow"==b.field||financial.requestedFields.push(b.field)}),financial.requestedFields.push("code"),financial.requestedFields.push("name"),financial.fields=b.fields,$.each(b.fields,function(a,b){if("logo"==b.field)return financial.hasLogos=!0,!1})}financial.init()},RiseVision.Financial.prototype.init=function(){var a=this,b={};this.financial=new RiseVision.Common.Financial.RealTime(this.displayID,this.instruments),this.useDefault?this.getData():this.layoutURL&&(b[gadgets.io.RequestParameters.CONTENT_TYPE]=gadgets.io.ContentType.DOM,gadgets.io.makeRequest(this.layoutURL,function(b){var c=b.data;if(c.getElementsByTagName("Style").length>0){var d=document.getElementsByTagName("head")[0],e=document.createElement("style");e.type="text/css",e.innerHTML=c.getElementsByTagName("Style")[0].childNodes[1].nodeValue,d.appendChild(e)}return 0==c.getElementsByTagName("Layout").length?void console.log("No Layout tag specified in custom layout file."):(a.layout=c.getElementsByTagName("Layout")[0].childNodes[1].nodeValue,void a.getData())},b))},RiseVision.Financial.prototype.getData=function(){var a=this;this.financial.getData(this.requestedFields,this.hasLogos,this.isChain(),function(b,c){b?(a.data=b,a.urls=c,a.arrowCount=0,$("#container").width(prefs.getString("rsW")),$("#container").height(prefs.getString("rsH")),a.isLoading?(a.loadArrow(a.logosURL+"animated-green-arrow.gif"),a.loadArrow(a.logosURL+"animated-red-arrow.gif")):(a.isChain()&&a.checkInstruments(!1),a.layoutURL?a.showCustomLayout():a.showDefaultLayout())):a.startTimer()})},RiseVision.Financial.prototype.loadArrow=function(a){var b=this,c=new Image;c.onload=function(){b.onArrowLoaded()},c.onerror=function(){b.onArrowLoaded()},c.src=a},RiseVision.Financial.prototype.onArrowLoaded=function(){this.arrowCount++,2==this.arrowCount&&(this.layoutURL?this.showCustomLayout():this.showDefaultLayout())},RiseVision.Financial.prototype.showDefaultLayout=function(){var a=null,b=null;(this.isLoading||this.isChain())&&(this.selectedIndex=$(".selected").index(),$("#container").empty(),a=document.createElement("div"),a.setAttribute("id","disclaimer"),a.setAttribute("class","default"),$("#container").append(a),b=document.createElement("table"),b.setAttribute("id","financial"),b.setAttribute("class","default page"),$("#container").append(b)),this.initTable()},RiseVision.Financial.prototype.showCustomLayout=function(){var a=0;if(this.isLoading||this.isChain()){a=this.data.getNumberOfRows(),$("#container").empty(),$("#container").append(this.layout);for(var b=0;b<a;b++){var c=$(".repeat:first").parent();b>0&&$(c).append($(".repeat:first").clone())}}this.initTable()},RiseVision.Financial.prototype.initTable=function(){var a=this,b=this.data.getNumberOfRows(),c=this.data.getNumberOfColumns();if(this.isLoading||this.isChain()){this.isLoading||$(".dataTables_scrollBody").infiniteScroll.stop(),c>0&&this.addHeadings();for(var d=0;d<b;d++)$(".repeat").eq(d).length>0?this.addRow(d,$(".repeat").eq(d)):this.addRow(d,null);this.selectedIndex!=-1&&$(".item").eq(this.selectedIndex).addClass("selected")}else this.updateRows();this.formatFields(),(this.isLoading||this.isChain())&&(this.sortConfig.aoColumnDefs=[],$.each(this.fields,function(b,c){c.width&&a.sortConfig.aoColumnDefs.push({sWidth:c.width,aTargets:[b]})}),$("#financial").dataTable(this.sortConfig),$(".dataTables_scrollHead table thead tr th, td").css({"padding-top":this.rowPadding,"padding-bottom":this.rowPadding}),$("table thead tr th, td").css({"padding-left":this.colPadding,"padding-right":this.colPadding}),$("table tr th:first-child, td:first-child").css({"padding-left":"10px"}),$("table tr th:last-child, td:last-child").css({"padding-right":"10px"}),$("#disclaimer").text("Market Data by Thomson Reuters - Delayed 20 Minutes"),$("#disclaimer").css("font-family",this.disclaimerFont),"bottomRight"==this.disclaimerLoc||"bottomLeft"==this.disclaimerLoc?($("#disclaimer").addClass("bottom"),"bottomRight"==this.disclaimerLoc&&$("#disclaimer").addClass("right")):($("#container").addClass("fullScreen"),$("#disclaimer").addClass("top"),"topRight"==this.disclaimerLoc&&$("#disclaimer").addClass("right")),$(".dataTables_scrollBody").height($("#container").outerHeight()-$("#disclaimer").outerHeight()-$(".dataTables_scrollHead").outerHeight()+"px")),$.each(this.fields,function(b,c){if("changeUp"==c.condition||"changeDown"==c.condition){var d=a.financial.compare(c.field);$.each(d,function(a,b){var d=$("td."+c.field).eq(a);"changeUp"==c.condition?1==b?d.addClass("changeUpIncrease"):b==-1?d.addClass("changeUpDecrease"):d.removeClass("changeUpIncrease changeUpDecrease"):1==b?d.addClass("changeDownIncrease"):b==-1?d.addClass("changeDownDecrease"):d.removeClass("changeDownIncrease changeDownDecrease")})}else if("valuePositive"==c.condition||"valueNegative"==c.condition){var d=a.financial.checkSigns(c.field);$.each(d,function(a,b){var d=$("td."+c.field).eq(a);"valuePositive"==c.condition?1==b?d.addClass("valuePositivePositive"):d.addClass("valuePositiveNegative"):1==b?d.addClass("valueNegativePositive"):d.addClass("valueNegativeNegative")})}}),(this.isLoading||this.isChain())&&$(".dataTables_scrollBody").infiniteScroll({scrollBy:prefs.getString("scrollBy"),direction:a.scrollDirection,duration:1e3*prefs.getInt("scrollHold"),speed:prefs.getString("scrollSpeed"),swipingTimeout:1e3*prefs.getInt("scrollResumes"),toggleOddEven:!0}).bind("onLastItemScrolled",function(b){a.onLastItemScrolled.call(a,b)}),$("#container").width("100%"),$("#container").height("95%"),this.isLoading?(this.isLoading=!1,readyEvent(),this.checkInstruments(!0)):$(".dataTables_scrollBody").infiniteScroll.start(),this.startTimer()},RiseVision.Financial.prototype.addHeadings=function(){var a=this,b=document.createElement("tr");$.each(this.fields,function(c,d){var e=document.createElement("th");"logo"==d.field?(e.setAttribute("class","logo"),$(e).html("Logo")):"instrument"==d.field?(e.setAttribute("class",a.data.getColumnId(0)),$(e).html(a.data.getColumnLabel(0))):(e.setAttribute("class",a.data.getColumnId(a.financial.dataFields[d.field])),$(e).html(a.data.getColumnLabel(a.financial.dataFields[d.field]))),$(e).addClass("heading_font-style"),$(b).append(e)}),$("#financial").prepend($("<thead>").append(b))},RiseVision.Financial.prototype.addRow=function(a,b){var e,c=this,d=-1;this.data.getNumberOfColumns();"INCORRECT_TYPE"==this.data.getFormattedValue(a,0)?console.log("Chain could not be displayed. Please check that only one chain is being requested and that chains are not being requested together with stocks."):(null==b?(b=document.createElement("tr"),b.setAttribute("class","item"),b.setAttribute("data-alias",this.data.getFormattedValue(a,0)),b.setAttribute("data-code",this.data.getFormattedValue(a,this.financial.dataFields.code))):(b.attr("data-alias",this.data.getFormattedValue(a,0)),b.attr("data-code",this.data.getFormattedValue(a,this.financial.dataFields.code))),$(b).on("click",function(a){$("tr").removeClass("selected"),$(this).addClass("selected"),gadgets.rpc.call("","instrumentSelected",null,$(this).attr("data-code"))}),$.each(this.fields,function(e,f){var g=document.createElement("td");"logo"==f.field?d=e:"instrument"==f.field?(g.setAttribute("class","data_font-style "+c.data.getColumnId(0)),$(g).html(c.data.getFormattedValue(a,0)),$(b).append(g)):(g.setAttribute("class","data_font-style "+c.data.getColumnId(c.financial.dataFields[f.field])),$(g).html(c.data.getFormattedValue(a,c.financial.dataFields[f.field])),$(g).attr("data-value",c.data.getFormattedValue(a,c.financial.dataFields[f.field])),$(b).append(g)),d!=-1&&e==c.fields.length-1&&(g=document.createElement("td"),g.setAttribute("class","data_font-style logo"),null!=c.urls[a]?($img=$("<img>"),$img.attr("src",c.urls[a]),$img.height(0),$(g).append($img)):$(g).html(c.data.getFormattedValue(a,c.financial.dataFields.name)),$(b).find("td").eq(d).before(g))}),this.useDefault&&$("#financial").append(b),$(".logo img").height($(b).height()),"N/P"==this.data.getFormattedValue(a,c.financial.dataFields.name)&&(e=this.splitInstruments(),e.splice(a,1),this.financial.setInstruments(e.join())))},RiseVision.Financial.prototype.updateRows=function(){for(var a,b=this,d=this.data.getNumberOfRows(),e=this.data.getNumberOfColumns(),f=0;f<d;f++)a=$("tr[data-alias='"+this.data.getFormattedValue(f,0)+"']:first"),0==a.length&&(a=$("tr[data-alias='N/A']"),0==a.length&&(a=$("tr[data-alias='...']")),a.length>0&&(a.attr("data-alias",this.data.getFormattedValue(f,0)),a.attr("data-code",this.data.getFormattedValue(f,e-1)))),a.length>0&&$.each(this.fields,function(c,d){var e=a.find("."+d.field);"logo"==d.field?null!=b.urls[f]?($img=$("<img>"),$img.attr("src",b.urls[f]),$img.height(a.height()),e.find("div").append($img)):e.html(b.data.getFormattedValue(f,b.financial.dataFields.name)):"instrument"==d.field?e.html(b.data.getFormattedValue(f,0)):(e.html(b.data.getFormattedValue(f,b.financial.dataFields[d.field])),e.attr("data-value",b.data.getFormattedValue(f,b.financial.dataFields[d.field])))})},RiseVision.Financial.prototype.formatFields=function(){var a=this;$.each(this.fields,function(b,c){if(c.field){var e,d=$("td."+c.field);d.length>0&&(d.hasClass("updated")||((a.isLoading||a.isChain())&&(c.header&&$("th").eq(b).html(c.header),a.isLoading&&c.width&&(e=parseInt(c.width),e=e/prefs.getInt("rsW")*100+"%",c.width=e),$("th").eq(b).css("text-align",c.alignment)),d.css("text-align",c.alignment),d.each(function(b){var d;if($(this).text()&&!isNaN($(this).text()))if($(this).text(parseFloat($(this).text()).toFixed(c.decimals)),d=$(this).attr("data-value"),d||(d=$(this).text()),"none"==c.sign)$(this).html(a.addCommas(Math.abs(d).toFixed(c.decimals)));else if("minus"==c.sign)$(this).html(a.addCommas(d));else if("plusMinus"==c.sign)parseFloat(d)>0&&$(this).html("+"+a.addCommas(d));else if("parentheses"==c.sign)parseFloat(d)<0&&$(this).html("("+a.addCommas(Math.abs(d).toFixed(c.decimals))+")");else if("arrow"==c.sign){var f=$("<img class='arrow'>");f.height($(this).height()),$(this).html(a.addCommas(Math.abs(d).toFixed(c.decimals))),parseFloat(d)<0?f.attr("src",a.logosURL+"animated-red-arrow.gif"):parseFloat(d)>=0&&f.attr("src",a.logosURL+"animated-green-arrow.gif"),$(this).prepend(f)}}),d.addClass("updated")))}}),$("td").removeClass("updated")},RiseVision.Financial.prototype.addCommas=function(a){a+="";for(var b=a.split("."),c=b[0],d=b.length>1?"."+b[1]:"",e=/(\d+)(\d{3})/;e.test(c);)c=c.replace(e,"$1,$2");return c+d},RiseVision.Financial.prototype.onLastItemScrolled=function(a){"page"!=this.scrollBy&&doneEvent(),this.checkForUpdates&&("page"==this.scrollBy?(this.checkForUpdates=!1,this.getData()):(this.checkForUpdates=!1,this.getData()))},RiseVision.Financial.prototype.startTimer=function(){var a=this;setTimeout(function(){"none"!=a.scrollDirection&&$(".dataTables_scrollBody").infiniteScroll.canScroll()?a.checkForUpdates=!0:a.getData()},this.updateInterval)},RiseVision.Financial.prototype.splitInstruments=function(){var a=this.instruments.split(",");return $.each(a,function(b,c){a[b]=$.trim(a[b])}),a},RiseVision.Financial.prototype.isChain=function(){var a=this.splitInstruments();return null!=this.data&&(1==a.length&&this.data.getNumberOfRows()>1)},RiseVision.Financial.prototype.play=function(){$(".dataTables_scrollBody").infiniteScroll.start()},RiseVision.Financial.prototype.pause=function(){$(".dataTables_scrollBody").infiniteScroll.pause()};