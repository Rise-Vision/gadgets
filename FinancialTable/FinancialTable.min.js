var RiseVision=RiseVision||{};RiseVision.FinancialSettings={},RiseVision.FinancialSettings=function(){this.settings=new RiseVision.Common.Settings},RiseVision.FinancialSettings.prototype.initSettings=function(){var e=this;$("#selector").on("click",function(){financial.showStockSelector()}),$(".colorPicker").on("click",function(){financial.showColorPicker($(this).data("for"))}),$(".fontSelector").on("click",function(){financial.showFontSelector($(this).data("for"))}),$("#scrollDirection").on("change",function(){"none"==$(this).val()?$("li.scroll").hide():$("li.scroll").show()}),$("#scrollBy").on("change",function(){"continuous"==$(this).val()?$("li.scrollHold").hide():$("li.scrollHold").show()}),$("#colCount").on("change",function(){financial.buildFieldsUI()}),$("#useDefault").on("click",function(){$(this).is(":checked")?$("li.layoutURL").hide():$("li.layoutURL").show()}),gadgets.rpc.call("","rscmd_getAdditionalParams",function(t){if(t){t=JSON.parse(t),$("#disclaimerFont").val(prefs.getString("disclaimerFont")),$("#disclaimerLoc").val(prefs.getString("disclaimerLoc")),$("#acceptance").attr("checked",prefs.getBool("acceptance")),$("#scrollDirection").val(prefs.getString("scrollDirection")),$("#scrollBy").val(prefs.getString("scrollBy")),$("#scrollHold").val(prefs.getInt("scrollHold")),$("#scrollSpeed").val(prefs.getString("scrollSpeed")),$("#scrollResumes").val(prefs.getInt("scrollResumes")),$("#rowPadding").val(prefs.getInt("rowPadding")),$("#colPadding").val(prefs.getInt("colPadding")),$("#colCount").val(prefs.getInt("colCount")),$("#bgColor").val(prefs.getString("bgColor")),$("#rowColor").val(prefs.getString("rowColor")),$("#altRowColor").val(prefs.getString("altRowColor")),$("#selRowColor").val(prefs.getString("selRowColor")),$("#useDefault").attr("checked",prefs.getBool("useDefault")),$("#layoutURL").val(prefs.getString("layoutURL")),e.populateColor($("#rowColor"),prefs.getString("rowColor")),e.populateColor($("#altRowColor"),prefs.getString("altRowColor")),e.populateColor($("#selRowColor"),prefs.getString("selRowColor")),e.populateColor($("#bgColor"),prefs.getString("bgColor")),$("#instruments").val(t.instruments),$("#heading_font-style").text(t.heading_font),$("#heading_font-style").data("css",t["heading_font-style"]),$("#data_font-style").text(t.data_font),$("#data_font-style").data("css",t["data_font-style"]),$("#colCount").trigger("change");for(var i=0;i<parseInt($("#colCount").val());i++)e.initFields(i+1,t.fields[i]);$(".field").trigger("change")}else $("#colCount").trigger("change"),$(".field").trigger("change");$("form ol li ol.drillDown li:visible:last").css({clear:"left","float":"left","margin-bottom":"10px"}),$("#scrollDirection").trigger("change"),$("#scrollBy").trigger("change"),$("#useDefault").triggerHandler("click"),$("#settings").show()})},RiseVision.FinancialSettings.prototype.populateColor=function(e,t){e.val(t),e.css("background-color",t)},RiseVision.FinancialSettings.prototype.initFields=function(e,t){$("#field"+e).val(t.field),$("#alignment"+e).val(t.alignment),$("#width"+e).val(t.width),$("#decimals"+e).val(t.decimals),$("#sign"+e).val(t.sign),$("#condition"+e+"Action").val(t.condition),$("#headerText"+e).val(t.header)},RiseVision.FinancialSettings.prototype.buildFieldsUI=function(){var e=parseInt($("#colCount").val()),t=$(".field").length;if(isNaN(e)||0==e)$(".formatting").hide();else if(e==t)$(".formatting").show();else if(t>e)$(".formatting").hide(),$(".formatting:lt("+e+")").show();else{$(".formatting").show();for(var i=t+1;e>=i;i++){var a=document.createElement("li"),n=document.createElement("ol");n.setAttribute("class","formatting drillDown"),$(n).append($("<li></li>").append("<label for='field"+i+"'>Field*:</label>").append("<select id='field"+i+"' name='field"+i+"' class='field medium'><option value='instrument'>Instrument</option><option value='logo'>Instrument Logo</option><option value='name'>Instrument Name</option><option value='lastPrice'>Last Price</option><option value='historicClose'>Previous Close</option><option value='netChange'>Change</option><option value='percentChange'>% Change</option><option value='accumulatedVolume'>Accumulated Volume</option><option value='dayHigh'>Day High</option><option value='dayLow'>Day Low</option><option value='yearHigh'>52 Week High</option><option value='yearLow'>52 Week Low</option><option value='bid'>Bid</option><option value='ask'>Ask</option><option value='yield'>Yield</option><option value='yieldChange'>Yield Change</option><option value='tradeTime'>Trade Time</option></select>")).append($("<li></li>").append("<label for='alignment"+i+"'>Alignment:</label>").append("<select id='alignment"+i+"' name='alignment"+i+"' class='alignment short'><option value='left' selected='selected'>Left</option><option value='center'>Center</option><option value='right'>Right</option></select>")).append($("<li></li>").append("<label for='width"+i+"'>Width (pixels):</label>").append("<input id='width"+i+"' name='width"+i+"' type='text' class='width short' />")).append($("<li></li>").append("<label for='headerText"+i+i+"'><a href='#' class='tooltip'>Header Text:<span>Custom header text. If not specified, the header from the field will be used.</span></a></label>").append("<input id='headerText"+i+"' name='headerText"+i+"' type='text' class='headerText short' />")).append($("<li class='numeric drilldown'></li>").append($("<ol></ol>").append($("<li></li>").append("<label for='decimals"+i+"'>Decimals:</label>").append("<select id='decimals"+i+"' name='decimals"+i+"' class='decimals short'><option value='0'>0</option><option value='1'>1</option><option value='2' selected='selected'>2</option><option value='3'>3</option><option value='4'>4</option></select>")).append($("<li></li>").append("<label for='sign"+i+"'><a href='#' class='tooltip'>Sign:<span>How to display positive and negative numbers</span></a></label>").append("<select id='sign"+i+"' name='sign"+i+"' class='sign short'><option value='none'>None</option><option value='minus'>-</option><option value='plusMinus'>+/-</option><option value='parentheses'>( )</option><option value='arrow' selected='selected'>Arrow</option></select>")).append($("<li></li>").append("<label for='condition"+i+"'><a href='#' class='tooltip'>Color Condition:<span>Whether or not to use color to indicate positive or negative values, or to indicate a change in value</span></a></label>").append("<select id='condition"+i+"Action' name='condition"+i+"Action' class='condition medium'><option value='none' selected='selected'>None</option><option value='changeUp'>Change Up Green Down Red</option><option value='changeDown'>Change Down Green Up Red</option><option value='valuePositive'>Value Positive Green Negative Red</option><option value='valueNegative'>Value Negative Green Positive Red</option></select>")))),$(a).append(n),$("#bgColor").parent().before(a),$(".field").on("change",function(){"instrument"!=this.value&&"logo"!=this.value&&"name"!=this.value&&"tradeTime"!=this.value?$(this).parent().parent().find(".numeric").show():$(this).parent().parent().find(".numeric").hide()})}for(var i=t+1;e>=i;i++)$(".field").eq(i-1)[0].selectedIndex=i-1}},RiseVision.FinancialSettings.prototype.showStockSelector=function(){gadgets.rpc.call("","rscmd_openFinancialSelector",null,"instruments",$("#instruments").val())},RiseVision.FinancialSettings.prototype.showColorPicker=function(e){gadgets.rpc.call("","rscmd_openColorPicker",null,e,$("#"+e).val())},RiseVision.FinancialSettings.prototype.showFontSelector=function(e){gadgets.rpc.call("","rscmd_openFontSelector",null,e,$("#"+e).data("css"))},RiseVision.FinancialSettings.prototype.setStocks=function(e,t){$("#"+e).val(t)},RiseVision.FinancialSettings.prototype.setColor=function(e,t){$("#"+e).val(t),$("#"+e).css("background-color",t)},RiseVision.FinancialSettings.prototype.setFont=function(e,t,i){$("#"+e).data("css",t),$("#"+e).text(i)},RiseVision.FinancialSettings.prototype.getSettings=function(){var e=!1,t=document.getElementsByClassName("errors")[0],i="",a=null;return $(".errors").empty(),e=financial.settings.validateRequired($("#instruments"),t,"Instruments")?!0:e,e=financial.settings.validateNumeric($("#scrollHold"),t,"Scroll Hold")?!0:e,e=financial.settings.validateNumeric($("#scrollResumes"),t,"Scroll Resumes")?!0:e,e=financial.settings.validateNumeric($("#rowPadding"),t,"Row Padding")?!0:e,e=financial.settings.validateNumeric($("#colPadding"),t,"Column Padding")?!0:e,parseInt($("#colCount").val())>0&&($(".field").each(function(){e=financial.settings.validateRequired($(this),t,"Field")?!0:e}),$(".width").each(function(){e=financial.settings.validateNumeric($(this),t,"Width")?!0:e})),e=financial.settings.validateRequired($("#layoutURL"),t,"Layout URL")?!0:e,e?($(".errors").fadeIn(200).css("display","inline-block"),$("#wrapper").scrollTop(0),null):(i="up_disclaimerFont="+$("#disclaimerFont").val()+"&up_disclaimerLoc="+$("#disclaimerLoc").val()+"&up_scrollDirection="+$("#scrollDirection").val()+"&up_scrollBy="+$("#scrollBy").val()+"&up_scrollHold="+$("#scrollHold").val()+"&up_scrollSpeed="+$("#scrollSpeed").val()+"&up_scrollResumes="+$("#scrollResumes").val()+"&up_rowPadding="+$("#rowPadding").val()+"&up_colPadding="+$("#colPadding").val()+"&up_colCount="+$("#colCount").val()+"&up_bgColor="+$("#bgColor").val()+"&up_rowColor="+$("#rowColor").val()+"&up_altRowColor="+$("#altRowColor").val()+"&up_selRowColor="+$("#selRowColor").val()+"&up_layoutURL="+escape($("#layoutURL").val()),i+=$("#acceptance").is(":checked")?"&up_acceptance=true":"&up_acceptance=false",i+=$("#useDefault").is(":checked")?"&up_useDefault=true":"&up_useDefault=false",a={params:i,additionalParams:JSON.stringify(financial.saveAdditionalParams())},$(".errors").css({display:"none"}),a)},RiseVision.FinancialSettings.prototype.saveAdditionalParams=function(){var e={},t=[];e.instruments=$("#instruments").val(),e.heading_font=$("#heading_font-style").text(),e["heading_font-style"]=$("#heading_font-style").data("css"),e.data_font=$("#data_font-style").text(),e["data_font-style"]=$("#data_font-style").data("css");for(var i=0;i<parseInt($("#colCount").val());i++)t.push(financial.saveFormatSettings(i+1,t));return e.fields=t,e},RiseVision.FinancialSettings.prototype.saveFormatSettings=function(e){var t={field:$("#field"+e).val(),alignment:$("#alignment"+e).val(),width:$("#width"+e).val(),header:$("#headerText"+e).val()};return $("#decimals"+e+":visible").length>0&&(t.decimals=$("#decimals"+e).val(),t.sign=$("#sign"+e).val(),t.condition=$("#condition"+e+"Action").val()),t},RiseVision.Financial={},RiseVision.Financial=function(e){this.displayID=e,this.scrollDirection=prefs.getString("scrollDirection"),this.scrollBy=prefs.getString("scrollBy"),this.scrollHold=1e3*prefs.getInt("scrollHold"),this.scrollSpeed=prefs.getString("scrollSpeed"),this.scrollResumes=1e3*prefs.getInt("scrollResumes"),this.rowPadding=prefs.getInt("rowPadding")/2+"px",this.colPadding=prefs.getInt("colPadding")/2+"px",this.disclaimerFont=prefs.getString("disclaimerFont"),this.disclaimerLoc=prefs.getString("disclaimerLoc"),this.useDefault=prefs.getBool("useDefault"),this.layoutURL=this.useDefault?"":prefs.getString("layoutURL"),this.logosURL="//s3.amazonaws.com/risecontentlogos/financial/",this.hasLogos=!1,this.hasLastItemScrolled=!1,this.updateInterval=6e4,this.selectedIndex=-1,this.isLoading=!0,this.sortConfig={bAutoWidth:!1,bDestroy:!0,bFilter:!1,bInfo:!1,bLengthChange:!1,bPaginate:!1,bSort:!1,sScrollY:"500px"}},RiseVision.Financial.prototype.getInstrument=function(e){return $("tr").removeClass("selected"),$(".item").eq(e).addClass("selected"),$(".item").eq(e).attr("data-code")},RiseVision.Financial.prototype.checkInstruments=function(e){var t=this,i=[],a=[],n=this.data.getNumberOfRows();e&&(this.requested=[]);for(var o=0;n>o;o++)i.push(this.data.getFormattedValue(o,this.financial.dataFields.code));a=$.grep(i,function(e){return-1==$.inArray(e,t.requested)});for(var s=0;s<a.length;s++)this.requested.push(a[s]);a.length>0&&gadgets.rpc.call("","instrumentsChanged",null,this.displayID,a),e&&setTimeout(function(){t.checkInstruments(!0)},864e5)},RiseVision.Financial.prototype.getAdditionalParams=function(e,t){if("additionalParams"==e&&t){var i=document.createElement("style");t=JSON.parse(t),i.appendChild(document.createTextNode(t["heading_font-style"])),i.appendChild(document.createTextNode(t["data_font-style"])),document.getElementsByTagName("head")[0].appendChild(i),financial.instruments=t.instruments,financial.requestedFields=[],$.each(t.fields,function(e,t){"name"==t.field||"logo"==t.field||"instrument"==t.field||"arrow"==t.field||financial.requestedFields.push(t.field)}),financial.requestedFields.push("code"),financial.requestedFields.push("name"),financial.fields=t.fields,$.each(t.fields,function(e,t){return"logo"==t.field?(financial.hasLogos=!0,!1):void 0})}financial.init()},RiseVision.Financial.prototype.init=function(){var e=this,t={};this.financial=new RiseVision.Common.Financial.RealTime(this.displayID,this.instruments),this.useDefault?this.getData():this.layoutURL&&(t[gadgets.io.RequestParameters.CONTENT_TYPE]=gadgets.io.ContentType.DOM,gadgets.io.makeRequest(this.layoutURL,function(t){var i=t.data;if(i.getElementsByTagName("Style").length>0){var a=document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",n.innerHTML=i.getElementsByTagName("Style")[0].childNodes[1].nodeValue,a.appendChild(n)}return 0==i.getElementsByTagName("Layout").length?void console.log("No Layout tag specified in custom layout file."):(e.layout=i.getElementsByTagName("Layout")[0].childNodes[1].nodeValue,void e.getData())},t))},RiseVision.Financial.prototype.getData=function(){var e=this;this.financial.getData(this.requestedFields,this.hasLogos,this.isChain(),function(t,i){t?(e.data=t,e.urls=i,e.arrowCount=0,$("#container").width(prefs.getString("rsW")),$("#container").height(prefs.getString("rsH")),e.isLoading?(e.loadArrow(e.logosURL+"animated-green-arrow.gif"),e.loadArrow(e.logosURL+"animated-red-arrow.gif")):(e.isChain()&&e.checkInstruments(!1),e.layoutURL?e.showCustomLayout():e.showDefaultLayout())):e.startTimer()})},RiseVision.Financial.prototype.loadArrow=function(e){var t=this,i=new Image;i.onload=function(){t.onArrowLoaded()},i.onerror=function(){t.onArrowLoaded()},i.src=e},RiseVision.Financial.prototype.onArrowLoaded=function(){this.arrowCount++,2==this.arrowCount&&(this.layoutURL?this.showCustomLayout():this.showDefaultLayout())},RiseVision.Financial.prototype.showDefaultLayout=function(){var e=null,t=null;(this.isLoading||this.isChain())&&(this.selectedIndex=$(".selected").index(),$("#container").empty(),e=document.createElement("div"),e.setAttribute("id","disclaimer"),e.setAttribute("class","default"),$("#container").append(e),t=document.createElement("table"),t.setAttribute("id","financial"),t.setAttribute("class","default page"),$("#container").append(t)),this.initTable()},RiseVision.Financial.prototype.showCustomLayout=function(){var e=0;if(this.isLoading||this.isChain()){e=this.data.getNumberOfRows(),$("#container").empty(),$("#container").append(this.layout);for(var t=0;e>t;t++){var i=$(".repeat:first").parent();t>0&&$(i).append($(".repeat:first").clone())}}this.initTable()},RiseVision.Financial.prototype.initTable=function(){var e=this,t=this.data.getNumberOfRows(),i=this.data.getNumberOfColumns();if(this.isLoading||this.isChain()){this.isLoading||$(".dataTables_scrollBody").infiniteScroll.stop(),i>0&&this.addHeadings();for(var a=0;t>a;a++)$(".repeat").eq(a).length>0?this.addRow(a,$(".repeat").eq(a)):this.addRow(a,null);-1!=this.selectedIndex&&$(".item").eq(this.selectedIndex).addClass("selected")}else this.updateRows();this.formatFields(),(this.isLoading||this.isChain())&&(this.sortConfig.aoColumnDefs=[],$.each(this.fields,function(t,i){i.width&&e.sortConfig.aoColumnDefs.push({sWidth:i.width,aTargets:[t]})}),$("#financial").dataTable(this.sortConfig),$(".dataTables_scrollHead table thead tr th, td").css({"padding-top":this.rowPadding,"padding-bottom":this.rowPadding}),$("table thead tr th, td").css({"padding-left":this.colPadding,"padding-right":this.colPadding}),$("table tr th:first-child, td:first-child").css({"padding-left":"10px"}),$("table tr th:last-child, td:last-child").css({"padding-right":"10px"}),$("#disclaimer").text("Market Data by Thomson Reuters - Delayed 20 Minutes"),$("#disclaimer").css("font-family",this.disclaimerFont),"bottomRight"==this.disclaimerLoc||"bottomLeft"==this.disclaimerLoc?($("#disclaimer").addClass("bottom"),"bottomRight"==this.disclaimerLoc&&$("#disclaimer").addClass("right")):($("#container").addClass("fullScreen"),$("#disclaimer").addClass("top"),"topRight"==this.disclaimerLoc&&$("#disclaimer").addClass("right")),$(".dataTables_scrollBody").height($("#container").outerHeight()-$("#disclaimer").outerHeight()-$(".dataTables_scrollHead").outerHeight()+"px")),$.each(this.fields,function(t,i){if("changeUp"==i.condition||"changeDown"==i.condition){var a=e.financial.compare(i.field);$.each(a,function(e,t){var a=$("td."+i.field).eq(e);"changeUp"==i.condition?1==t?a.addClass("changeUpIncrease"):-1==t?a.addClass("changeUpDecrease"):a.removeClass("changeUpIncrease changeUpDecrease"):1==t?a.addClass("changeDownIncrease"):-1==t?a.addClass("changeDownDecrease"):a.removeClass("changeDownIncrease changeDownDecrease")})}else if("valuePositive"==i.condition||"valueNegative"==i.condition){var a=e.financial.checkSigns(i.field);$.each(a,function(e,t){var a=$("td."+i.field).eq(e);a.addClass("valuePositive"==i.condition?1==t?"valuePositivePositive":"valuePositiveNegative":1==t?"valueNegativePositive":"valueNegativeNegative")})}}),(this.isLoading||this.isChain())&&$(".dataTables_scrollBody").infiniteScroll({scrollBy:prefs.getString("scrollBy"),direction:e.scrollDirection,duration:1e3*prefs.getInt("scrollHold"),speed:prefs.getString("scrollSpeed"),swipingTimeout:1e3*prefs.getInt("scrollResumes"),toggleOddEven:!0}).bind("onLastItemScrolled",function(t){e.onLastItemScrolled.call(e,t)}),$("#container").width("100%"),$("#container").height("95%"),this.isLoading?(this.isLoading=!1,readyEvent(),this.checkInstruments(!0)):$(".dataTables_scrollBody").infiniteScroll.start(),this.startTimer()},RiseVision.Financial.prototype.addHeadings=function(){var e=this,t=document.createElement("tr");$.each(this.fields,function(i,a){var n=document.createElement("th");"logo"==a.field?(n.setAttribute("class","logo"),$(n).html("Logo")):"instrument"==a.field?(n.setAttribute("class",e.data.getColumnId(0)),$(n).html(e.data.getColumnLabel(0))):(n.setAttribute("class",e.data.getColumnId(e.financial.dataFields[a.field])),$(n).html(e.data.getColumnLabel(e.financial.dataFields[a.field]))),$(n).addClass("heading_font-style"),$(t).append(n)}),$("#financial").prepend($("<thead>").append(t))},RiseVision.Financial.prototype.addRow=function(e,t){{var i,a=this,n=-1;this.data.getNumberOfColumns()}"INCORRECT_TYPE"==this.data.getFormattedValue(e,0)?console.log("Chain could not be displayed. Please check that only one chain is being requested and that chains are not being requested together with stocks."):(null==t?(t=document.createElement("tr"),t.setAttribute("class","item"),t.setAttribute("data-alias",this.data.getFormattedValue(e,0)),t.setAttribute("data-code",this.data.getFormattedValue(e,this.financial.dataFields.code))):(t.attr("data-alias",this.data.getFormattedValue(e,0)),t.attr("data-code",this.data.getFormattedValue(e,this.financial.dataFields.code))),$(t).on("click",function(){$("tr").removeClass("selected"),$(this).addClass("selected"),gadgets.rpc.call("","instrumentSelected",null,$(this).attr("data-code"))}),$.each(this.fields,function(i,o){var s=document.createElement("td");"logo"==o.field?n=i:"instrument"==o.field?(s.setAttribute("class","data_font-style "+a.data.getColumnId(0)),$(s).html(a.data.getFormattedValue(e,0)),$(t).append(s)):(s.setAttribute("class","data_font-style "+a.data.getColumnId(a.financial.dataFields[o.field])),$(s).html(a.data.getFormattedValue(e,a.financial.dataFields[o.field])),$(s).attr("data-value",a.data.getFormattedValue(e,a.financial.dataFields[o.field])),$(t).append(s)),-1!=n&&i==a.fields.length-1&&(s=document.createElement("td"),s.setAttribute("class","data_font-style logo"),null!=a.urls[e]?($img=$("<img>"),$img.attr("src",a.urls[e]),$img.height(0),$(s).append($img)):$(s).html(a.data.getFormattedValue(e,a.financial.dataFields.name)),$(t).find("td").eq(n).before(s))}),this.useDefault&&$("#financial").append(t),$(".logo img").height($(t).height()),"N/P"==this.data.getFormattedValue(e,a.financial.dataFields.name)&&(i=this.splitInstruments(),i.splice(e,1),this.financial.setInstruments(i.join())))},RiseVision.Financial.prototype.updateRows=function(){for(var e,t=this,i=this.data.getNumberOfRows(),a=this.data.getNumberOfColumns(),n=0;i>n;n++)e=$("tr[data-alias='"+this.data.getFormattedValue(n,0)+"']:first"),0==e.length&&(e=$("tr[data-alias='N/A']"),0==e.length&&(e=$("tr[data-alias='...']")),e.length>0&&(e.attr("data-alias",this.data.getFormattedValue(n,0)),e.attr("data-code",this.data.getFormattedValue(n,a-1)))),e.length>0&&$.each(this.fields,function(i,a){var o=e.find("."+a.field);"logo"==a.field?null!=t.urls[n]?($img=$("<img>"),$img.attr("src",t.urls[n]),$img.height(e.height()),o.find("div").append($img)):o.html(t.data.getFormattedValue(n,t.financial.dataFields.name)):"instrument"==a.field?o.html(t.data.getFormattedValue(n,0)):(o.html(t.data.getFormattedValue(n,t.financial.dataFields[a.field])),o.attr("data-value",t.data.getFormattedValue(n,t.financial.dataFields[a.field])))})},RiseVision.Financial.prototype.formatFields=function(){var e=this;$.each(this.fields,function(t,i){if(i.field){var a,n=$("td."+i.field);n.length>0&&(n.hasClass("updated")||((e.isLoading||e.isChain())&&(i.header&&$("th").eq(t).html(i.header),e.isLoading&&i.width&&(a=parseInt(i.width),a=a/prefs.getInt("rsW")*100+"%",i.width=a),$("th").eq(t).css("text-align",i.alignment)),n.css("text-align",i.alignment),n.each(function(){var t;if($(this).text()&&!isNaN($(this).text()))if($(this).text(parseFloat($(this).text()).toFixed(i.decimals)),t=$(this).attr("data-value"),t||(t=$(this).text()),"none"==i.sign)$(this).html(e.addCommas(Math.abs(t).toFixed(i.decimals)));else if("minus"==i.sign)$(this).html(e.addCommas(t));else if("plusMinus"==i.sign)parseFloat(t)>0&&$(this).html("+"+e.addCommas(t));else if("parentheses"==i.sign)parseFloat(t)<0&&$(this).html("("+e.addCommas(Math.abs(t).toFixed(i.decimals))+")");else if("arrow"==i.sign){var a=$("<img class='arrow'>");a.height($(this).height()),$(this).html(e.addCommas(Math.abs(t).toFixed(i.decimals))),parseFloat(t)<0?a.attr("src",e.logosURL+"animated-red-arrow.gif"):parseFloat(t)>=0&&a.attr("src",e.logosURL+"animated-green-arrow.gif"),$(this).prepend(a)}}),n.addClass("updated")))}}),$("td").removeClass("updated")},RiseVision.Financial.prototype.addCommas=function(e){e+="";for(var t=e.split("."),i=t[0],a=t.length>1?"."+t[1]:"",n=/(\d+)(\d{3})/;n.test(i);)i=i.replace(n,"$1,$2");return i+a},RiseVision.Financial.prototype.onLastItemScrolled=function(){"page"!=this.scrollBy&&doneEvent(),this.checkForUpdates&&("page"==this.scrollBy?(this.checkForUpdates=!1,this.getData()):(this.checkForUpdates=!1,this.getData()))},RiseVision.Financial.prototype.startTimer=function(){var e=this;setTimeout(function(){"none"!=e.scrollDirection&&$(".dataTables_scrollBody").infiniteScroll.canScroll()?e.checkForUpdates=!0:e.getData()},this.updateInterval)},RiseVision.Financial.prototype.splitInstruments=function(){var e=this.instruments.split(",");return $.each(e,function(t){e[t]=$.trim(e[t])}),e},RiseVision.Financial.prototype.isChain=function(){var e=this.splitInstruments();return null!=this.data?1==e.length&&this.data.getNumberOfRows()>1:!1},RiseVision.Financial.prototype.play=function(){$(".dataTables_scrollBody").infiniteScroll.start()},RiseVision.Financial.prototype.pause=function(){$(".dataTables_scrollBody").infiniteScroll.pause()};